<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¹é«”ä¸­æ–‡ AI å­¸ç¿’å·¥å…· - ä½œè€… Wilson</title>
    <script src="https://unpkg.com/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>

    <style>
        /* 1. å¼•å…¥æ³¨éŸ³å­—å‹ (ä¾†æºï¼šbuttaiwan) */
        @font-face {
            font-family: 'BpmfPlus';
            src: url('https://cdn.jsdelivr.net/gh/buttaiwan/bpmfvs@v1.200/dist/BpmfGenSenRounded-R.woff2') format('woff2');
            font-display: swap;
        }

        :root {
            --primary-color: #4a7c59; 
            --accent-color: #d97706;  
            --bg-color: #fdfbf7;      
        }

        body { 
            font-family: "Microsoft JhengHei", sans-serif; 
            background-color: var(--bg-color); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 20px;
        }

        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 24px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.05); 
            text-align: center; 
            max-width: 450px; 
            width: 100%; 
        }

        /* 2. æ³¨éŸ³é¡¯ç¤ºæ¨£å¼ï¼šä½¿ç”¨æ³¨éŸ³å­—å‹ */
        .zhuyin-display {
            font-family: 'BpmfPlus', serif; /* å¥—ç”¨æ³¨éŸ³å­—å‹ */
            font-size: 80px; /* å­—å‹æœ¬èº«åŒ…å«æ¼¢å­—èˆ‡æ³¨éŸ³ï¼Œå»ºè­°æ”¾å¤§çœ‹æ›´æ¸…æ¥š */
            color: var(--accent-color);
            margin: 10px 0;
            cursor: pointer;
            line-height: 1.2;
        }

        #character-target { 
            width: 280px; 
            height: 280px; 
            border: 4px solid #f1f5f9; 
            background: #fff; 
            border-radius: 20px;
            margin: 20px auto;
        }

        .controls { display: flex; gap: 12px; margin-top: 10px; }
        button { 
            padding: 12px 20px; 
            font-size: 16px; 
            cursor: pointer; 
            background: var(--primary-color); 
            color: white; 
            border: none; 
            border-radius: 12px; 
            font-weight: bold;
            flex: 1;
        }

        /* ä½œè€…æ¨™ç½² */
        .footer {
            margin-top: 30px;
            color: #94a3b8;
            font-size: 14px;
            font-weight: bold;
        }

        .status-msg { margin: 15px 0; font-weight: bold; }
        .loading { color: var(--primary-color); }
    </style>
</head>
<body>

    <div class="container">
        <h1>ç¹é«”ä¸­æ–‡ AI ç­†ç•«</h1>
        
        <div style="display:flex; gap:10px; justify-content:center; margin-bottom:20px;">
            <input type="text" id="charInput" maxlength="1" placeholder="å­—" style="font-size:24px; width:70px; text-align:center; border-radius:10px; border:2px solid #eee;">
            <button onclick="queryCharacter()">æœå°‹</button>
        </div>
        
        <div id="statusMsg" class="status-msg"></div>

        <div id="result-area" style="display:none;">
            <div id="zhuyinBox" class="zhuyin-display" onclick="speakText()" title="é»æ“Šè½ç™¼éŸ³"></div>
            
            <div id="character-target"></div>
            
            <div class="controls">
                <button style="background:#64748b;" onclick="writer.animateCharacter()">é‡æ’­</button>
                <button id="quizBtn" style="background:#059669;" onclick="toggleQuiz()">æ‰‹å¯«æ¸¬é©—</button>
            </div>
        </div>

        <div class="footer">ä½œè€…ï¼šWilson</div>
    </div>

    <script>
        let writer = null;
        let isQuiz = false;
        let currentChar = "";

        function speakText() {
            if (!currentChar) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(currentChar);
            utterance.lang = 'zh-TW';
            window.speechSynthesis.speak(utterance);
        }

        async function queryCharacter() {
            const char = document.getElementById('charInput').value.trim();
            const statusMsg = document.getElementById('statusMsg');
            const resultArea = document.getElementById('result-area');
            const target = document.getElementById('character-target');
            const zhuyinBox = document.getElementById('zhuyinBox');

            if (!char || !/[\u4e00-\u9fa5]/.test(char)) {
                statusMsg.innerText = "è«‹è¼¸å…¥ä¸€å€‹ä¸­æ–‡å­—";
                return;
            }

            currentChar = char;
            statusMsg.className = "status-msg loading";
            statusMsg.innerText = "ğŸ” è¼‰å…¥ä¸­...";
            target.innerHTML = '';
            resultArea.style.display = "none";

            // ç›´æ¥å°‡å­—å¡«å…¥æ³¨éŸ³å­—å‹å€åŸŸ
            zhuyinBox.innerText = char;

            writer = HanziWriter.create('character-target', char, {
                width: 280,
                height: 280,
                padding: 15,
                showOutline: true,
                strokeColor: '#334155',
                charDataLoader: async function(charToLoad, onComplete) {
                    const res = await fetch(`
